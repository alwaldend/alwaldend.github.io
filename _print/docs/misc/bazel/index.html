<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="https://alwaldend.com/docs/misc/bazel/">
<link rel="alternate" type="application/rss&#43;xml" href="https://alwaldend.com/docs/misc/bazel/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Bazel | Alwaldend</title>
<meta name="description" content="Advantages Hermetic builds Dependency graph Local build and test cache Remote cache Remote execution Unified API for builds, tasks, and tests Disadvantages Additional layer of abstraction and complexity Weird edge cases and occasional bugs Lack of support, documentation, and information on the internet The majority of advantages are irrelevant for the majority of codebases .bazelrc has variables %workspace%: Workspace directory https://bazel.build/run/bazelrc
Local registry module is cached If you changed a local registry module, but bazel still uses the old version, restart bazel: bazel shutdown">
<meta property="og:url" content="https://alwaldend.com/docs/misc/bazel/">
  <meta property="og:site_name" content="Alwaldend">
  <meta property="og:title" content="Bazel">
  <meta property="og:description" content="Advantages Hermetic builds Dependency graph Local build and test cache Remote cache Remote execution Unified API for builds, tasks, and tests Disadvantages Additional layer of abstraction and complexity Weird edge cases and occasional bugs Lack of support, documentation, and information on the internet The majority of advantages are irrelevant for the majority of codebases .bazelrc has variables %workspace%: Workspace directory https://bazel.build/run/bazelrc
Local registry module is cached If you changed a local registry module, but bazel still uses the old version, restart bazel: bazel shutdown">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2000-01-01T03:00:00+03:00">
    <meta property="article:tag" content="Bazel">

  <meta itemprop="name" content="Bazel">
  <meta itemprop="description" content="Advantages Hermetic builds Dependency graph Local build and test cache Remote cache Remote execution Unified API for builds, tasks, and tests Disadvantages Additional layer of abstraction and complexity Weird edge cases and occasional bugs Lack of support, documentation, and information on the internet The majority of advantages are irrelevant for the majority of codebases .bazelrc has variables %workspace%: Workspace directory https://bazel.build/run/bazelrc
Local registry module is cached If you changed a local registry module, but bazel still uses the old version, restart bazel: bazel shutdown">
  <meta itemprop="dateModified" content="2000-01-01T03:00:00+03:00">
  <meta itemprop="wordCount" content="183">
  <meta itemprop="keywords" content="Bazel">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Bazel">
  <meta name="twitter:description" content="Advantages Hermetic builds Dependency graph Local build and test cache Remote cache Remote execution Unified API for builds, tasks, and tests Disadvantages Additional layer of abstraction and complexity Weird edge cases and occasional bugs Lack of support, documentation, and information on the internet The majority of advantages are irrelevant for the majority of codebases .bazelrc has variables %workspace%: Workspace directory https://bazel.build/run/bazelrc
Local registry module is cached If you changed a local registry module, but bazel still uses the old version, restart bazel: bazel shutdown">
<link rel="preload" href="/scss/main.min.988a146c65ef793ae6145654705b7a4aca318d43123c51df956be40671e18198.css" as="style" integrity="sha256-mIoUbGXveTrmFFZUcFt6SsoxjUMSPFHflWvkBnHhgZg=" crossorigin="anonymous">
<link href="/scss/main.min.988a146c65ef793ae6145654705b7a4aca318d43123c51df956be40671e18198.css" rel="stylesheet" integrity="sha256-mIoUbGXveTrmFFZUcFt6SsoxjUMSPFHflWvkBnHhgZg=" crossorigin="anonymous">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">Alwaldend</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/docs/"><span>Docs</span></a>
      </li>
      <li class="td-light-dark-menu nav-item dropdown">
        <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="check2" viewBox="0 0 16 16">
    <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
  </symbol>
  <symbol id="circle-half" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
  </symbol>
  <symbol id="moon-stars-fill" viewBox="0 0 16 16">
    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
    <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
  </symbol>
  <symbol id="sun-fill" viewBox="0 0 16 16">
    <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
  </symbol>
</svg>

<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center"
        id="bd-theme"
        type="button"
        aria-expanded="false"
        data-bs-toggle="dropdown"
        data-bs-display="static"
        aria-label="Toggle theme (auto)">
  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#sun-fill"></use></svg>
      Light
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"></use></svg>
      Dark
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
      <svg class="bi me-2 opacity-50"><use href="#circle-half"></use></svg>
      Auto
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
</ul>

      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.a01af7848767ae5ec59071d4d461799a.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
<div class="td-content">
	<h1>Bazel</h1>
	
	<header class="article-meta">
		<div class="taxonomy taxonomy-terms-article taxo-categories">
  <h5 class="taxonomy-title">Categories:</h5>
  <ul class="taxonomy-terms">
    <li><a class="taxonomy-term" href="https://alwaldend.com/categories/misc/" data-taxonomy-term="misc"><span class="taxonomy-label">Misc</span></a></li>
    </ul>
</div>
<div class="taxonomy taxonomy-terms-article taxo-tags">
  <h5 class="taxonomy-title">Tags:</h5>
  <ul class="taxonomy-terms">
    <li><a class="taxonomy-term" href="https://alwaldend.com/tags/bazel/" data-taxonomy-term="bazel"><span class="taxonomy-label">Bazel</span></a></li>
    </ul>
</div>

</header>
	<h2 id="advantages">Advantages<a class="td-heading-self-link" href="#advantages" aria-label="Heading self-link"></a></h2>
<ul>
<li>Hermetic builds</li>
<li>Dependency graph</li>
<li>Local build and test cache</li>
<li>Remote cache</li>
<li>Remote execution</li>
<li>Unified API for builds, tasks, and tests</li>
</ul>
<h2 id="disadvantages">Disadvantages<a class="td-heading-self-link" href="#disadvantages" aria-label="Heading self-link"></a></h2>
<ul>
<li>Additional layer of abstraction and complexity</li>
<li>Weird edge cases and occasional bugs</li>
<li>Lack of support, documentation, and information on the internet</li>
<li>The majority of advantages are irrelevant for the majority of codebases</li>
</ul>
<h2 id="bazelrc-has-variables">.bazelrc has variables<a class="td-heading-self-link" href="#bazelrc-has-variables" aria-label="Heading self-link"></a></h2>
<ul>
<li><code>%workspace%</code>: Workspace directory</li>
</ul>
<p><a href="https://bazel.build/run/bazelrc">https://bazel.build/run/bazelrc</a></p>
<h2 id="local-registry-module-is-cached">Local registry module is cached<a class="td-heading-self-link" href="#local-registry-module-is-cached" aria-label="Heading self-link"></a></h2>
<p>If you changed a local registry module, but bazel still uses the old version,
restart bazel: <code>bazel shutdown</code></p>
<p><a href="https://github.com/bazelbuild/bazel/issues/20477#issuecomment-1851057077">https://github.com/bazelbuild/bazel/issues/20477#issuecomment-1851057077</a></p>
<h2 id="output-root-ownership">Output root ownership<a class="td-heading-self-link" href="#output-root-ownership" aria-label="Heading self-link"></a></h2>
<p>Bazel checks ownership of the output root at startup, so it will fail with
<code>mkdir('/path/to/dir'): (error: 13): Permission denied</code> if the current user does
not own the directory.</p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ bazel --client_debug
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>FATAL 15:19:33.457 src/main/cpp/blaze_util_posix.cc:499<span style="color:#f92672">]</span> mkdir<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;/path/to/dir&#39;</span><span style="color:#f92672">)</span>: <span style="color:#f92672">(</span>error: 13<span style="color:#f92672">)</span>: Permission denied
</span></span></code></pre></div><p>Traceback:</p>
<ul>
<li><a href="https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/blaze_util_posix.cc#L497">https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/blaze_util_posix.cc#L497</a></li>
<li><a href="https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L518">https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L518</a></li>
<li><a href="https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L90">https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L90</a></li>
<li><a href="https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L48">https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L48</a></li>
<li><a href="https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L67">https://github.com/bazelbuild/bazel/blob/d798ebde6c6394203a87b5f1a6b62ecfc3880991/src/main/cpp/util/file_posix.cc#L67</a></li>
</ul>
<h2 id="js_binary-does-not-work-for-some-reason">js_binary does not work for some reason<a class="td-heading-self-link" href="#js_binary-does-not-work-for-some-reason" aria-label="Heading self-link"></a></h2>
<p>One of possible errors:</p>
<pre tabindex="0"><code>FATAL: aspect_rules_js[js_binary]: RUNFILES environment variable is not set
</code></pre><h3 id="solutions">Solutions<a class="td-heading-self-link" href="#solutions" aria-label="Heading self-link"></a></h3>
<h4 id="run-the-binary-that-fixes-it-for-some-reason">Run the binary (that fixes it for some reason)<a class="td-heading-self-link" href="#run-the-binary-that-fixes-it-for-some-reason" aria-label="Heading self-link"></a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>bazel run //tools:postcss
</span></span></code></pre></div><h4 id="run-pnpm-install-sometimes-node_modules-directory-is-not-up-to-date">Run <code>pnpm install</code> (sometimes node_modules directory is not up-to-date)<a class="td-heading-self-link" href="#run-pnpm-install-sometimes-node_modules-directory-is-not-up-to-date" aria-label="Heading self-link"></a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>bazel run -- tools:pnpm --dir <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PWD<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> install
</span></span></code></pre></div>
	
</div>


          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        
      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        
Built with Hugo <a href="/hugo_env.txt">0.152.2</a>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.bbd51c4d8821b00d332d12d5eb4b11de66b17866799c8a262d5fea4c4eee94d0.js" integrity="sha256-u9UcTYghsA0zLRLV60sR3maxeGZ5nIomLV/qTE7ulNA=" crossorigin="anonymous"></script>
<script defer src="/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
